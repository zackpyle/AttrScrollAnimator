/*! AttrScrollAnimator by Zack Pyle - v1.2.0 - https://snippetnest.com/snippet/simple-scroll-triggered-animations-with-data-attributes/ */
class AttrScrollAnimator{constructor(e={}){this.options={viewportPosition:.75,...e},this.observedElements=new Set,this.positionObservers=new Map,this.observedThresholds=new Map,this.hasAnimatedIn=new Set,this.debugLines=new Map,this.childrenAnimations=new Map,this.debugColors=["hsl(160, 100%, 40%)","hsl(220, 100%, 40%)","hsl(280, 100%, 40%)","hsl(330, 100%, 40%)","hsl(0, 100%, 40%)"],this.debouncedRefresh=this.debounce(this.refresh.bind(this),200),window.addEventListener("resize",this.debouncedRefresh),window.addEventListener("load",()=>this.init())}parseThreshold(e){if(!e)return this.options.viewportPosition;if(e.endsWith("px"))return parseInt(e,10)/window.innerHeight;let t=parseFloat(e);return isNaN(t)?this.options.viewportPosition:t}generateColorForThreshold(e){return this.debugColors[e%this.debugColors.length]}debounce(e,t){let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>e(...i),t)}}createDebugLabel(e,t){let s=document.createElement("div");return s.className="scroll-animation-debug",s.textContent=e,Object.assign(s.style,{position:"absolute",left:"0",top:"-1.2em",fontSize:"12px",background:"white",color:t,padding:"2px 6px",border:`1px solid ${t}`,borderRadius:"3px"}),s.style.setProperty("visibility","visible","important"),s.style.setProperty("display","block","important"),s.style.setProperty("opacity","1","important"),s}createLine(e,t,s,i=!1){let r=document.createElement("div");return r.className="scroll-animation-debug-line scroll-animation-debug",Object.assign(r.style,{position:i?"fixed":"absolute",top:`${t}px`,left:"0",width:"100%",height:"0",borderTop:`2px dashed ${s}`,zIndex:"9999",pointerEvents:"none"}),r.style.setProperty("visibility","visible","important"),r.style.setProperty("display","block","important"),r.style.setProperty("opacity","1","important"),r.appendChild(this.createDebugLabel(e,s)),document.body.appendChild(r),r}createPositionObserver(e){if(!this.positionObservers.has(e)){let t=window.innerHeight,s=t*e,i=new IntersectionObserver(e=>this.handleIntersection(e),{threshold:0,rootMargin:`${-s}px 0px ${-(t-s-1)}px 0px`});this.positionObservers.set(e,i)}return this.positionObservers.get(e)}parseStaggerDelay(e){if(!e)return 0;if(e.endsWith("ms"));else if(e.endsWith("s"))return 1e3*parseFloat(e);return parseFloat(e)}animateChildren(e,t){let s=e.getAttribute("data-scroll-animation-class"),i=e.getAttribute("data-scroll-children"),r;r=i&&"true"!==i?Array.from(e.querySelectorAll(`.${i}`)).filter(e=>!e.classList.contains("scroll-animation-trigger-line")&&!e.classList.contains("scroll-animation-debug")):Array.from(e.children).filter(e=>!e.classList.contains("scroll-animation-trigger-line")&&!e.classList.contains("scroll-animation-debug")),this.childrenAnimations.has(e)&&this.childrenAnimations.get(e).forEach(e=>clearTimeout(e));let n=e.getAttribute("data-scroll-animation-reverse"),o=n&&"true"!==n?n:null,a=e.getAttribute("data-scroll-children-stagger"),l=a?this.parseStaggerDelay(a):0,h=[];r.forEach((e,i)=>{if(!a){t?(e.classList.add(s),o&&e.classList.remove(o)):n&&(e.classList.remove(s),o&&e.classList.add(o));return}let r=setTimeout(()=>{t?(e.classList.add(s),o&&e.classList.remove(o)):n&&(e.classList.remove(s),o&&e.classList.add(o))},i*l);h.push(r)}),h.length>0&&this.childrenAnimations.set(e,h)}handleIntersection(e){e.forEach(e=>{let t=e.target,s=t.getAttribute("data-scroll-animation-class"),i=t.getAttribute("data-scroll-animation-reverse"),r=this.observedThresholds.get(t)??this.options.viewportPosition;if(!s)return;let n=window.innerHeight*r,o=e.boundingClientRect.top,a=i&&"true"!==i?i:null,l=t.getAttribute("data-scroll-children"),h=l&&"false"!==l;o<=n?(!h&&(t.classList.add(s),a&&t.classList.remove(a)),this.hasAnimatedIn.add(t),h&&this.animateChildren(t,!0)):i&&this.hasAnimatedIn.has(t)&&(h?this.animateChildren(t,!1):(t.classList.remove(s),a&&t.classList.add(a)))})}init(){let e=document.querySelectorAll("[data-scroll-animation-class]");e.forEach((e,t)=>{let s=e.getAttribute("data-scroll-animation-class");if(!s||e.classList.contains(s))return;let i=e.getAttribute("data-scroll-animation-threshold"),r=this.parseThreshold(i),n=this.createPositionObserver(r);if(n.observe(e),this.observedElements.add(e),this.observedThresholds.set(e,r),"true"===e.getAttribute("data-scroll-debug")){let o=this.generateColorForThreshold(t),a=()=>{let t=this.createLine(`Threshold (${r})`,window.innerHeight*r,o,!0),s=document.createElement("div");s.className="scroll-animation-trigger-line scroll-animation-debug",Object.assign(s.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"0",borderTop:`2px dashed ${o}`,pointerEvents:"none",zIndex:"9999"}),s.style.setProperty("visibility","visible","important"),s.style.setProperty("display","block","important"),s.style.setProperty("opacity","1","important"),s.appendChild(this.createDebugLabel(`Trigger - (Threshold ${r})`,o)),"static"===getComputedStyle(e).position&&(e.style.position="relative"),e.appendChild(s),this.debugLines.set(e,[s,t])},l=0,h=()=>{l<5?(l++,requestAnimationFrame(h)):a()};h()}})}refresh(){this.destroy(),this.init()}destroy(){window.removeEventListener("resize",this.debouncedRefresh),this.positionObservers.forEach(e=>e.disconnect()),this.positionObservers.clear(),this.observedElements.clear(),this.observedThresholds.clear(),this.hasAnimatedIn.clear(),this.childrenAnimations.forEach(e=>{e.forEach(e=>clearTimeout(e))}),this.childrenAnimations.clear(),this.debugLines.forEach(e=>e.forEach(e=>e.remove())),this.debugLines.clear()}}const attrScrollAnimation=new AttrScrollAnimator;window.attrScrollAnimation=attrScrollAnimation;
